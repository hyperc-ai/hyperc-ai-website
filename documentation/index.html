<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Documentation - HyperC</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Documentation | HyperC</title> <meta name="generator" content="Jekyll v4.2.1" /> <meta property="og:title" content="Documentation" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="HyperC is the autonomous planning database." /> <meta property="og:description" content="HyperC is the autonomous planning database." /> <link rel="canonical" href="https://hyperc.ai/documentation/" /> <meta property="og:url" content="https://hyperc.ai/documentation/" /> <meta property="og:site_name" content="HyperC" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Documentation" /> <script type="application/ld+json"> {"@type":"WebPage","url":"https://hyperc.ai/documentation/","headline":"Documentation","description":"HyperC is the autonomous planning database.","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://hyperc.ai/" class="site-title lh-tight"> HyperC </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://hyperc.ai/" class="nav-list-link">Home</a></li><li class="nav-list-item active"><a href="https://hyperc.ai/documentation/" class="nav-list-link active">Documentation</a></li><li class="nav-list-item"><a href="https://hyperc.ai/architecture/" class="nav-list-link">Architecture</a></li><li class="nav-list-item"><a href="https://hyperc.ai/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search HyperC" aria-label="Search HyperC" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/hyperc-ai" class="site-button" target="_blank" rel="noopener noreferrer" > HyperC on GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <details open=""> <summary class="text-delta"> Table of contents </summary> <ol id="markdown-toc"> <li><a href="#general-structure" id="markdown-toc-general-structure">General Structure</a></li> <li><a href="#gentle-intro-example" id="markdown-toc-gentle-intro-example">Gentle Intro Example</a></li> <li><a href="#procedures-programming" id="markdown-toc-procedures-programming">Procedures Programming</a></li> <li><a href="#query-language" id="markdown-toc-query-language">Query Language</a> <ol> <li><a href="#initializing-tables" id="markdown-toc-initializing-tables">Initializing Tables</a></li> <li><a href="#transit" id="markdown-toc-transit">TRANSIT</a> <ol> <li><a href="#returns" id="markdown-toc-returns">Returns</a></li> <li><a href="#description" id="markdown-toc-description">Description</a></li> <li><a href="#hc_plan-table" id="markdown-toc-hc_plan-table">hc_plan table</a></li> </ol> </li> </ol> </li> </ol> </details> <h1 id="general-structure"> <a href="#general-structure" class="anchor-heading" aria-labelledby="general-structure"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> General Structure </h1> <p>HyperC is composed of a core library <a href="https://github.com/hyperc-ai/hyperc">hyperc</a>, the relational data interpretation layer <a href="https://github.com/hyperc-ai/hyper-etable">hyper-etable</a>, database interoperability <a href="https://github.com/hyperc-ai/hyperc-psql-proxy">hyperc-psql-proxy</a> and a nice Python integration module called <a href="https://github.com/hyperc-ai/ordered">ordered</a></p> <p>HyperC has a layered approach (see <a href="/architecture/">architecture</a>) centered around Python and PDDL.</p> <p>You define the data in objects of types (or rows of tables in database terminology), define procedures or actions that can modify the data, and the goal state to reach. HyperC will then select the correct procedures to run to get to that state.</p> <p>You can choose to write procedures directly as pure Python files and run with <a href="https://github.com/hyperc-ai/ordered">ordered</a> or you can work with a <a href="https://github.com/hyperc-ai/hypercdb">pre-packaged PostgreSQL interface</a> that offers built-in data management, procedure storage and planning in one package. The ability to write and test procedures in Python may be helpful to construct and debug larger models.</p> <h1 id="gentle-intro-example"> <a href="#gentle-intro-example" class="anchor-heading" aria-labelledby="gentle-intro-example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gentle Intro Example </h1> <p>To understand goal-oriented programming, let’s look at the simplest example in Python:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">hyperc</span> <span class="kn">import</span> <span class="n">solve</span>

<span class="k">class</span> <span class="nc">Numbers</span><span class="p">:</span>
    <span class="n">i</span><span class="p">:</span> <span class="nb">int</span>

<span class="n">n0</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">()</span>
<span class="n">n0</span><span class="p">.</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">inc</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="n">Numbers</span><span class="p">):</span>
    <span class="n">n</span><span class="p">.</span><span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">goal</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="n">Numbers</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">n</span><span class="p">.</span><span class="n">i</span> <span class="o">==</span> <span class="mi">3</span>

<span class="n">solve</span><span class="p">(</span><span class="n">goal</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">n0</span><span class="p">.</span><span class="n">i</span><span class="p">)</span>  <span class="c1"># =&gt; 3
</span></code></pre></div></div> <p>This code defines the end goal to solve for a state where some object of type <code class="language-plaintext highlighter-rouge">Numbers</code> will have <code class="language-plaintext highlighter-rouge">&lt;object Numbers&gt;.i == 3</code>. Given is the function that takes object and increments the property <code class="language-plaintext highlighter-rouge">i</code> and one object with a star value <code class="language-plaintext highlighter-rouge">.i=0</code>. The resulting plan when HyperC solves this is:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">inc</span><span class="p">(</span><span class="n">n0</span><span class="p">)</span>
<span class="n">inc</span><span class="p">(</span><span class="n">n0</span><span class="p">)</span>
<span class="n">inc</span><span class="p">(</span><span class="n">n0</span><span class="p">)</span>
</code></pre></div></div> <p>The same task in the database will look like this:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">numbers</span> <span class="p">(</span> <span class="n">id</span> <span class="nb">integer</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span> <span class="n">i</span> <span class="nb">integer</span> <span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">numbers</span> <span class="k">VALUES</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="n">inc</span><span class="p">(</span><span class="n">n</span> <span class="n">numbers</span><span class="p">)</span> <span class="k">LANGUAGE</span> <span class="s1">'hyperc'</span> <span class="k">AS</span> <span class="err">$$</span>
<span class="n">n</span><span class="p">.</span><span class="n">I</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="err">$$</span><span class="p">;</span>
<span class="n">TRANSIT</span> <span class="k">UPDATE</span> <span class="n">numbers</span> <span class="k">SET</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</code></pre></div></div> <p>the <code class="language-plaintext highlighter-rouge">TRANSIT UPDATE</code> command tells HyperC to reach the state of the table <code class="language-plaintext highlighter-rouge">numbers</code> that would have been set by the proposed <code class="language-plaintext highlighter-rouge">UPDATE</code>.</p> <p>Note that we always have to have some KEY column in the table that will not be modified, so we had to create an additional <code class="language-plaintext highlighter-rouge">id</code> column. Also as databases don’t distinguish column name case, uppercase column names is a requirement.</p> <p>You will get the output</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">step_num</span>   <span class="o">|</span>  <span class="n">proc_name</span> <span class="o">|</span> <span class="n">op_type</span>
<span class="c1">-----------+------------+---------</span>
         <span class="mi">0</span> <span class="o">|</span>  <span class="n">inc</span>       <span class="o">|</span> <span class="n">STEP</span>
         <span class="mi">1</span> <span class="o">|</span>  <span class="n">inc</span>       <span class="o">|</span> <span class="n">STEP</span>
         <span class="mi">2</span> <span class="o">|</span>  <span class="n">inc</span>       <span class="o">|</span> <span class="n">STEP</span>
        <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>            <span class="o">|</span> <span class="k">UPDATE</span>
</code></pre></div></div> <p>and as expected,</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">numbers</span><span class="p">;</span>
 <span class="n">id</span> <span class="o">|</span> <span class="n">i</span> 
<span class="c1">----+---</span>
  <span class="mi">0</span> <span class="o">|</span> <span class="mi">3</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</code></pre></div></div> <p>we can try to roll back using <code class="language-plaintext highlighter-rouge">TRANSIT UPDATE</code>:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">TRANSIT</span> <span class="k">UPDATE</span> <span class="n">numbers</span> <span class="k">SET</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">ERROR</span><span class="p">:</span>  <span class="n">hyperc</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">SchedulingError</span><span class="p">:</span> <span class="n">Obtained</span> <span class="n">proof</span> <span class="n">that</span> <span class="n">task</span> <span class="n">has</span> <span class="k">no</span> <span class="n">solution</span>
</code></pre></div></div> <p>which obviously fails as there is no set of procedures that could be applied to set the column <code class="language-plaintext highlighter-rouge">i</code> to <code class="language-plaintext highlighter-rouge">0</code>.</p> <p>Sending a normal <code class="language-plaintext highlighter-rouge">UPDATE</code> will fix the table back to original state:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">numbers</span> <span class="k">SET</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">UPDATE</span> <span class="mi">1</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">numbers</span><span class="p">;</span>
 <span class="n">id</span> <span class="o">|</span> <span class="n">i</span> 
<span class="c1">----+---</span>
  <span class="mi">0</span> <span class="o">|</span> <span class="mi">0</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</code></pre></div></div> <h1 id="procedures-programming"> <a href="#procedures-programming" class="anchor-heading" aria-labelledby="procedures-programming"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Procedures Programming </h1> <p>HyperC accepts writing procedures in a subset of Python language. By writing the procedures, you define the allowed transitions within the database. We refer to a complete set of procedures as the “business schema”.</p> <p>Let’s use this code as an example:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">move_truck</span><span class="p">(</span><span class="n">truck</span><span class="p">:</span> <span class="n">Trucks</span><span class="p">,</span> <span class="n">waypoint_pair</span><span class="p">:</span> <span class="n">Waypoints</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">truck</span><span class="p">.</span><span class="n">LOCATION</span> <span class="o">==</span> <span class="n">waypoint_pair</span><span class="p">.</span><span class="n">FROM_LOCATION</span>
    <span class="n">truck</span><span class="p">.</span><span class="n">LOCATION</span> <span class="o">=</span> <span class="n">waypoint_pair</span><span class="p">.</span><span class="n">TO_LOCATION</span>
    <span class="n">truck</span><span class="p">.</span><span class="n">ODOMETER</span> <span class="o">+=</span> <span class="n">waypoint_pair</span><span class="p">.</span><span class="n">POINTS_DISTANCE</span>
</code></pre></div></div> <p>When adding the code to the database, the procedure can be created with:</p><pre><code class="language-SQL">CREATE PROCEDURE move_truck(t trucks, l location_adjacency)
LANGUAGE 'hyperc'
AS $BODY$
assert truck.LOCATION == waypoint_pair.FROM_LOCATION
truck.LOCATION = waypoint_pair.TO_LOCATION
truck.ODOMETER += waypoint_pair.POINTS_DISTANCE
$BODY$;
</code></pre><p>Which is almost exact equivalent aside from that it’s not indented.</p> <p>The line with <code class="language-plaintext highlighter-rouge">assert</code> defines the condition when this function can be run - when objects <code class="language-plaintext highlighter-rouge">truck</code> and <code class="language-plaintext highlighter-rouge">waypoint_pair</code> are related in a way that <code class="language-plaintext highlighter-rouge">LOCATION</code> property of <code class="language-plaintext highlighter-rouge">truck</code> equals <code class="language-plaintext highlighter-rouge">FROM_LOCATION</code> of waypoint_pair. You can think of this constraint as a JOIN between tables <code class="language-plaintext highlighter-rouge">Trucks</code> and <code class="language-plaintext highlighter-rouge">Waypoints</code> but with only a single pair of them taken from the join when a function is executed.</p> <p>The last two lines update the respective values of a row (object).</p> <p>There is a limit of what can be done in HyperC’ Python dialect: only plain Python is supported with if/assert, integers, bools and strings.</p> <h1 id="query-language"> <a href="#query-language" class="anchor-heading" aria-labelledby="query-language"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Query Language </h1> <p>HyperCDB is based on <a href="https://www.postgresql.org/docs/14/index.html">PostgreSQL database v.14</a> and most functions of the database work as expected.</p> <p>We extend SQL language with the <code class="language-plaintext highlighter-rouge">TRANSIT *</code> set of commands:</p> <h2 id="initializing-tables"> <a href="#initializing-tables" class="anchor-heading" aria-labelledby="initializing-tables"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Initializing Tables </h2> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TRANSIT INIT
</code></pre></div></div> <p>Prepares the database for planning function.</p> <h2 id="transit"> <a href="#transit" class="anchor-heading" aria-labelledby="transit"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TRANSIT </h2> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ EXPLAIN [ TO table_name1[.column], table_name2, ... ]] TRANSIT UPDATE table_name
   SET { column = { expression | DEFAULT } |
          ( column [, ...] ) = ( { expression | DEFAULT } [, ...] ) } [, ...]
    [ WHERE condition ]
</code></pre></div></div> <h3 id="returns"> <a href="#returns" class="anchor-heading" aria-labelledby="returns"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Returns </h3> <p>A table with the plan.</p> <h3 id="description"> <a href="#description" class="anchor-heading" aria-labelledby="description"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Description </h3> <p><code class="language-plaintext highlighter-rouge">TRANSIT UPDATE</code> initiates transition to the state defined by UPDATE statement with familiar SQL syntax of <a href="https://www.postgresql.org/docs/14/sql-update.html">UPDATE</a>. It returns the table of the plan with unique plan_id that can be remembered and used to query <code class="language-plaintext highlighter-rouge">hc_plan</code> table to recall this plan at any later time.</p> <p><code class="language-plaintext highlighter-rouge">EXPLAIN TRANSIT ...</code> - initiates calculation of the plan, stores and outputs the plan table but does not do any actual updates to the state.</p> <p><code class="language-plaintext highlighter-rouge">EXPLAIN TO *table_name*, ... TRANSIT ...</code> - instructs the solver to only write down changes to tables (and possibly columns) specified after <code class="language-plaintext highlighter-rouge">TO</code> keyword.</p> <p>Examples:</p> <p>Calculate transition plan but only write down <code class="language-plaintext highlighter-rouge">odometer</code> reading, leaving truck at its original location:</p><pre><code class="language-SQL">EXPLAIN TO trucks.odometer TRANSIT UPDATE trucks SET location = 'Office';
</code></pre><hr /> <h3 id="hc_plan-table"> <a href="#hc_plan-table" class="anchor-heading" aria-labelledby="hc_plan-table"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> hc_plan table </h3> <p>HyperCDB defines a special table <code class="language-plaintext highlighter-rouge">hc_plan</code> to incrementally store all plans with called procedure names and input/output parameters in JSONB objects.</p> <p>The purpose of hc_plan table is to easily extract additional information from the plans like tracing the truck travel path, measuring fuel consumption, etc.</p> <p>When TRANSIT command completes, it outputs the plan table back to the user connection. <code class="language-plaintext highlighter-rouge">plan_id</code> can be extracted and remembered by the client application to select this plan from later.</p> <hr> <footer> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/hyperc-ai/hyperc-ai-website/tree/master/documentation.markdown" id="edit-this-page">Edit this page on GitHub.</a> </p> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
